% –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ –æ–∫—Ä—É–∂–Ω–æ—?—Ç–∏ –≤ –ø–ª–æ—?–∫–æ—?—Ç–∏ –æ–¥–Ω–æ–≥–æ –í–° –æ—Ç–Ω–æ—?–∏—Ç–µ–ª—å–Ω–æ –¥—Ä—É–≥–æ–≥–æ.
% –ü–µ—Ä–≤—ã–π —?–∞–º–æ–ª–µ—Ç –¥–≤–∏–∂–µ—Ç—?—? —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø—Ä—?–º–æ–ª–∏–Ω–µ–π–Ω–æ —?–æ —?–∫–æ—Ä–æ—?—Ç—å—é vx_plane, vy_plane
% –∏ —?–≤–ª—?–µ—Ç—?—? —Ü–µ–Ω—Ç—Ä–æ–º  —?–∏—?—Ç–µ–º—ã –æ—Ç—?—á–µ—Ç–∞
% –≤—Ç–æ—Ä–æ–π —?–∞–º–æ–ª–µ—Ç –¥–µ–ª–∞–µ—Ç –ø–æ–≤–æ—Ä–æ—Ç
% –¥–∞–Ω–æ: t0 - –Ω–∞—á–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—?;
% t1 - –∫–æ–Ω–µ—á–Ω–æ–µ –≤—Ä–µ–º—?;
% dt - —á–∞—?—Ç–æ—Ç–∞ –¥–∏—?–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏;
% (x0,y0) - –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞ –æ—Ç–Ω–æ—?–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–≤–æ–≥–æ;
% (vx,vy) - –Ω–∞—á–∞–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä —?–∫–æ—Ä–æ—?—Ç–∏ –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞;
% w - —É–≥–ª–æ–≤–∞—? —?–∫–æ—Ä–æ—?—Ç—å –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞;
% (x,y) - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞ –≤ —?–∏—?—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–µ—Ä–≤–æ–≥–æ
% (xc, yc) - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –ø–æ–≤–æ—Ä–æ—Ç–∞ –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞ –≤ —?–∏—?—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–µ—Ä–≤–æ–≥–æ
% —?–∞–º–æ–ª–µ—Ç–∞

function [x, y, t, vvx, vvy, N, xc, yc, psi_out] = standartTurnFromUniformPlane(t0, t1, dt, vx_plane, vy_plane, x0, y0, vx, vy, w, psi_in)
if (w == 0)
    x = x0;     y = y0;     t = t0;  vvx = vx; vvy = vy;
    return
end

% –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞
t = t0+dt:dt:t1;
% —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—? –¥–≤–∏–∂–µ–Ω–∏—? –ø–µ—Ä–≤–æ–≥–æ –≤ –∞–±—?–æ–ª—é—Ç–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö
x_first = vx_plane * t;
y_first = vy_plane * t;

%plot(x_first, y_first)

% –æ—Ç–Ω–æ—?–∏—Ç–µ–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ x0, y0 –≤—Ç–æ—Ä–æ–≥–æ —?–∞–º–æ–ª–µ—Ç–∞
% –æ—Ç–Ω–æ—?–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–≤–æ–≥–æ
x0_moving = -x0 + x_first;
y0_moving = -y0 + y_first;

% —Ü–µ–Ω—Ç—Ä –æ–∫—Ä—É–∂–Ω–æ—?—Ç–∏
% xc = x0 - vy / w;
% yc = y0 + vx / w;

xc = x0_moving - vy / w;
yc = y0_moving + vx / w;


v = sqrt(vx^2 + vy^2);                   % –º–æ–¥—É–ª—å —?–∫–æ—Ä–æ—?—Ç–∏
rad = v / abs(w);                             % —Ä–∞–¥–∏—É—? –æ–∫—Ä—É–∂–Ω–æ—?—Ç–∏

phi = atan2(-vx,vy);       % –Ω–∞—á–∞–ª—å–Ω–∞—? —Ñ–∞–∑–∞

% —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—?

x = xc + rad * cos(w * (t - t0) + phi);
y = yc + rad * sin(w * (t - t0) + phi);
vvx =  - rad * w * sin(w * (t - t0) + phi);
vvy =  rad * w * cos(w * (t - t0) + phi);
N = length(x);

psi_out = [psi_in zeros(1,length(t))] ;
for kk = 1:length(t)
    psi_out(kk+1) = mod(psi_out(kk) + w * 180 * dt / pi, 360) ;
end

end